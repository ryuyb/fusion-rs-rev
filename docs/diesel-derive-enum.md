## Setup with Diesel CLI

This crate integrates nicely with
[diesel-cli](http://diesel.rs/guides/configuring-diesel-cli.html) -
this is the recommended workflow.
Note that for now, this **only** works with Postgres - for other databases,
or if not using Diesel CLI, see the next section.

Cargo.toml:
```toml
[dependencies]
diesel-derive-enum = { version = "3.0.0-beta.1", features = ["postgres"] }
```

Suppose our project has the following `diesel.toml` (as generated by `diesel setup`):

``` toml
[print_schema]
file = "src/schema.rs"
custom_type_derives = ["diesel::query_builder::QueryId", "Clone"]
```

And the following SQL:
```sql
CREATE TYPE my_enum AS ENUM ('foo', 'bar', 'baz_quxx');

CREATE TABLE my_table (
  id SERIAL PRIMARY KEY,
  some_enum my_enum NOT NULL
);
```

Then running `$ diesel migration run` will generate code something like:

```rust
// src/schema.rs -- autogenerated

pub mod sql_types {
    #[derive(diesel::sql_types::SqlType, diesel::query_builder::QueryId, Clone)]
    #[diesel(postgres_type(name = "my_enum"))]
    pub struct MyEnum;
}

table! {
    use diesel::types::Integer;
    use super::sql_types::MyEnum;

    my_table {
        id -> Integer,
        some_enum -> MyEnum
    }
}
```

Now we can use `diesel-derive-enum` to hook in our own enum:

```rust
// src/my_code.rs

#[derive(diesel_derive_enum::DbEnum)]
#[db_enum(existing_type_path = "crate::schema::sql_types::MyEnum")]
pub enum MyEnum {
    Foo,
    Bar,
    BazQuxx,
}
```

Note the `db_enum(existing_type_path = "...")` attribute. This instructs this crate to import the
(remote, autogenerated) type and implement various traits upon it. That's it!
Now we can use `MyEnum` with `diesel` (see 'Usage' below).

## Usage

Once set up, usage is similar regardless of your chosen database.
We can define a struct with which to populate/query the table:

``` rust
#[derive(Insertable, Queryable, Identifiable, Debug, PartialEq)]
#[diesel(table_name = my_table)]
struct  MyRow {
    id: i32,
    some_enum: MyEnum,
}
```

And use it in the natural way:

```rust
let data = vec![
    MyRow {
        id: 1,
        some_enum: MyEnum::Foo,
    },
    MyRow {
        id: 2,
        some_enum: MyEnum::BazQuxx,
    },
];
let connection = PgConnection::establish(/*...*/).unwrap();
let inserted = insert_into(my_table::table)
    .values(&data)
    .get_results(&connection)
    .unwrap();
assert_eq!(data, inserted);
```
